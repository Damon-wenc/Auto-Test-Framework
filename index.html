<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Auto-test-framework by Damon-wenc</title>

    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="javascripts/scale.fix.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
  </head>
  <body>
    <div class="wrapper">
      <header>
        <h1 class="header">Auto-test-framework</h1>
        <p class="header">An automatic &amp; light test system based on html &amp; python; python do the logic, and web(html) display it.</p>

        <ul>
          <li class="download"><a class="buttons" href="https://github.com/Damon-wenc/Auto-Test-Framework/zipball/master">Download ZIP</a></li>
          <li class="download"><a class="buttons" href="https://github.com/Damon-wenc/Auto-Test-Framework/tarball/master">Download TAR</a></li>
          <li><a class="buttons github" href="https://github.com/Damon-wenc/Auto-Test-Framework">View On GitHub</a></li>
        </ul>

        <p class="header">This project is maintained by <a class="header name" href="https://github.com/Damon-wenc">Damon-wenc</a></p>


      </header>
      <section>
        <h1>
<a name="auto-test-framework" class="anchor" href="#auto-test-framework"><span class="octicon octicon-link"></span></a>Auto-Test-Framework</h1>

<h2>
<a name="english-version" class="anchor" href="#english-version"><span class="octicon octicon-link"></span></a>English version</h2>

<h3>
<a name="keywords" class="anchor" href="#keywords"><span class="octicon octicon-link"></span></a>Keywords</h3>

<p>An automatic &amp; light mass-clients test framework based on Python &amp; HTML; python do the logic, and web(HTML) display it.</p>

<h3>
<a name="description" class="anchor" href="#description"><span class="octicon octicon-link"></span></a>description</h3>

<p>This is not a complete auto-test system, it's just a upper layer test framework, sort of a 'Control Center', allow you to master a mass of devices; whatever tests you are about to run on your device is not included, but this framework will help you senting 'start/stop' commands via SSH, and collecting test logs to monitor test progress, and eventually the web will show the test results to you in a clear way.</p>

<h3>
<a name="structure" class="anchor" href="#structure"><span class="octicon octicon-link"></span></a>Structure</h3>

<p>The code is less than 600 lines, the structure of the framework is like thils:
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/structure.png" alt="structure"></p>

<ul>
<li>
<strong>web_tornado.py</strong> is the base, it's powered by <a href="http://www.tornadoweb.org/en/stable/">tornado</a>, a powerful library of Python; it process requests like 'GET index/init/run/stop/open_log';</li>
<li>
<strong>GLOBAL.py</strong> saves global variables;</li>
<li>
<strong>init_by_ping.py</strong> detecting whether your devices are online by fetch the return value of 'ping' cmd;</li>
<li>
<strong>run_test.py</strong> send commands/retrieve log/analysis log with multi-threading;</li>
<li>
<strong>ssh.py</strong> connecting to your devices with 'plink' tool, with a mechanism of re-connect;</li>
<li>
<strong>analysis.py</strong> analysis retrieved log by matching 'error keywords'</li>
</ul><h3>
<a name="examples" class="anchor" href="#examples"><span class="octicon octicon-link"></span></a>Examples</h3>

<ol>
<li>root page: this is the page shown up after you run web_tornado.py
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/index.jpg" alt="index">
You can see we could monitor 100 or more devices here.</li>
<li>step 2, click the 'init' button
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/init.jpg" alt="init">
Now there are 80 devices online, with color green, and the other 20 devices are offline, with color grey</li>
<li>step 3, click the 'run' button
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/run.jpg" alt="run">
Now the program begins to run, error occurred on any devices will turn the color of the devices from green to red, and logs from those particular devices will not longer be updated. So if you click the table url, if the device is OK, as green, the latest folder will shown up automatically; while if you click the wrong ones, as red, the log of the failed round will shown up.</li>
<li>step 4, if you want to finish the test, click the 'stop' button.</li>
</ol><h3>
<a name="details" class="anchor" href="#details"><span class="octicon octicon-link"></span></a>Details</h3>

<p>Please watch the code by urself :D</p>

<h3>
<a name="implementation" class="anchor" href="#implementation"><span class="octicon octicon-link"></span></a>Implementation</h3>

<p>The code is tested with Python version 2.7 on Windows. All you need to install is tornado library, please follow the <a href="http://www.tornadoweb.org/en/stable/#installation">official guide</a>. And if your OS is *nix, you may rewrite the ssh.py module with more properly libraries, like paramiko.</p>

<h3>
<a name="last-words" class="anchor" href="#last-words"><span class="octicon octicon-link"></span></a>Last words</h3>

<p>This is just a light&amp;clear upper level control framework, what you are intending to do on your device is not included,  'send' -&gt; 'run' -&gt; 'retrieve log' -&gt; 'analysis log' is a complete loop.
This is a idea about 'auto-test on mass of devices', how you are about to implement it or what, that is for you to decide. XD</p>

<h2>
<a name="%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E" class="anchor" href="#%E4%B8%AD%E6%96%87%E8%AF%B4%E6%98%8E"><span class="octicon octicon-link"></span></a>中文说明</h2>

<h3>
<a name="%E4%B8%80%E5%8F%A5%E8%AF%9D%E7%BB%BC%E8%BF%B0" class="anchor" href="#%E4%B8%80%E5%8F%A5%E8%AF%9D%E7%BB%BC%E8%BF%B0"><span class="octicon octicon-link"></span></a>一句话综述</h3>

<p>这是一个由Python&amp;HTML构建的轻量级大规模自动化测试框架; Python作逻辑层, HTML来显示.</p>

<h3>
<a name="%E8%AE%BE%E8%AE%A1%E5%AE%9A%E4%BD%8D" class="anchor" href="#%E8%AE%BE%E8%AE%A1%E5%AE%9A%E4%BD%8D"><span class="octicon octicon-link"></span></a>设计定位</h3>

<p>这不是是一个完整的自动化测试系统, 仅仅是一个上层的测试框架, 类似于一个控制中心, 下层的系统内的各种测试并不包含在内, 但是可以通过ssh来发送'start'命令, 通过收集'日志'接口来获取状态log, 等等来完成整套测试. 同时HTML(web)能清晰直白地显示出测试结果, 方便测试员观察.</p>

<h3>
<a name="%E6%A1%86%E6%9E%B6" class="anchor" href="#%E6%A1%86%E6%9E%B6"><span class="octicon octicon-link"></span></a>框架</h3>

<p>整套代码不到600行, 大体框架如下图
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/structure.png" alt="structure"></p>

<ul>
<li>
<strong>web_tornado.py</strong>是主函数, 由<a href="http://www.tornadoweb.org/en/stable/">tornado</a>这个库发力, 主要处理index/init/run/stop/open log各个请求动作</li>
<li>
<strong>GLOBAL.py</strong>保存全局变量</li>
<li>
<strong>init_by_ping.py</strong>用抓取ping返回值的方式判断设备是否存活</li>
<li>
<strong>run_test.py</strong>采用多线程的方式处理发送命令/抓取log/分析log的操作</li>
<li>
<strong>ssh.py</strong>藉由plink连接各设备, 有重连机制</li>
<li>
<strong>analysis.py</strong>用抓取错误关键字的方式分析log</li>
</ul><h3>
<a name="%E7%95%8C%E9%9D%A2%E7%A4%BA%E4%BE%8B" class="anchor" href="#%E7%95%8C%E9%9D%A2%E7%A4%BA%E4%BE%8B"><span class="octicon octicon-link"></span></a>界面示例</h3>

<ol>
<li>首先是运行web_tornado.py后的根页面
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/index.jpg" alt="index">
这里展示了对100台设备进行管理.</li>
<li>第二步, 敲击init键
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/init.jpg" alt="init">
例如这是前80台设备在线, 以绿色标识; 灰色设备是不在线.</li>
<li>第三步, 敲击run键
<img src="https://github.com/Damon-wenc/Auto-Test-Framework/raw/master/examples/run.jpg" alt="run">
此时程序已开始运行, 并且出现问题的设备会用红色标识. 点击各表格, 会跳转到相应的log轮次. 例如绿色的会跳转到96轮log, 红色则跳转到出问题的那一轮. 红色的设备将不继续进程后续测试. </li>
<li>第四步, 当所有测试完后需点击stop键</li>
</ol><h3>
<a name="%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1" class="anchor" href="#%E8%AF%A6%E7%BB%86%E8%AE%BE%E8%AE%A1"><span class="octicon octicon-link"></span></a>详细设计</h3>

<p>请点击左上角自行阅读源代码:D</p>

<h3>
<a name="%E9%83%A8%E7%BD%B2" class="anchor" href="#%E9%83%A8%E7%BD%B2"><span class="octicon octicon-link"></span></a>部署</h3>

<p>代码已在Windows平台上的Python 2.7版本下测试通过. 你需要的只是安装好tornado库, 可以参照<a href="http://www.tornadoweb.org/en/stable/#installation">官方文档</a>, 其中一些库你可能需要找Windows的编译版本. 若你是要在*nix平台上运行此代码, 你需要重写ssh.py模块, 利用更标准的库, 例如paramiko等.</p>

<h3>
<a name="%E6%9C%80%E5%90%8E%E8%AF%B4%E6%98%8E" class="anchor" href="#%E6%9C%80%E5%90%8E%E8%AF%B4%E6%98%8E"><span class="octicon octicon-link"></span></a>最后说明</h3>

<p>这只是一个上层的清晰明了的控制框架, 下层怎么实现取决于你, 最终只要能抓取到测试的log则算一个完整的来回. 这只是一个对于大规模测试的抱砖引玉的idea, 具体怎么实施, 那将由你来决定!</p>
      </section>
      <footer>
        <p><small>Hosted on <a href="http://pages.github.com">GitHub Pages</a> using the Dinky theme</small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
		
  </body>
</html>
